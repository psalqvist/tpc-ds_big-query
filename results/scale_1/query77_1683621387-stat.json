{"kind":"bigquery#job","etag":"sMUQYyjloAizxMWcjmjpRA==","id":"elite-fabric-384711:US.query77_1683621387","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/elite-fabric-384711/jobs/query77_1683621387?location=US","user_email":"salqvist.philip@gmail.com","configuration":{"query":{"query":"\n-- query77\nWITH ss AS \n( \n SELECT s_store_sk, \n Sum(ss_ext_sales_price) AS sales, \n Sum(ss_net_profit) AS profit \n FROM store_sales, \n date_dim, \n store \n WHERE ss_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2001-08-16' AS DATE) AND ( \n Cast('2001-09-15' AS DATE)) \n AND ss_store_sk = s_store_sk \n GROUP BY s_store_sk) , sr AS \n( \n SELECT s_store_sk, \n sum(sr_return_amt) AS returns1, \n sum(sr_net_loss) AS profit_loss \n FROM store_returns, \n date_dim, \n store \n WHERE sr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND sr_store_sk = s_store_sk \n GROUP BY s_store_sk), cs AS \n( \n SELECT cs_call_center_sk, \n sum(cs_ext_sales_price) AS sales, \n sum(cs_net_profit) AS profit \n FROM catalog_sales, \n date_dim \n WHERE cs_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n GROUP BY cs_call_center_sk ), cr AS \n( \n SELECT cr_call_center_sk, \n sum(cr_return_amount) AS returns1, \n sum(cr_net_loss) AS profit_loss \n FROM catalog_returns, \n date_dim \n WHERE cr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n GROUP BY cr_call_center_sk ), ws AS \n( \n SELECT wp_web_page_sk, \n sum(ws_ext_sales_price) AS sales, \n sum(ws_net_profit) AS profit \n FROM web_sales, \n date_dim, \n web_page \n WHERE ws_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND ws_web_page_sk = wp_web_page_sk \n GROUP BY wp_web_page_sk), wr AS \n( \n SELECT wp_web_page_sk, \n sum(wr_return_amt) AS returns1, \n sum(wr_net_loss) AS profit_loss \n FROM web_returns, \n date_dim, \n web_page \n WHERE wr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND wr_web_page_sk = wp_web_page_sk \n GROUP BY wp_web_page_sk) \nSELECT\n channel , \n id , \n sum(sales) AS sales , \n sum(returns1) AS returns1 , \n sum(profit) AS profit \nFROM ( \n SELECT 'store channel' AS channel , \n ss.s_store_sk AS id , \n sales , \n COALESCE(returns1, 0) AS returns1 , \n (profit - COALESCE(profit_loss,0)) AS profit \n FROM ss \n LEFT JOIN sr \n ON ss.s_store_sk = sr.s_store_sk \n UNION ALL \n SELECT 'catalog channel' AS channel , \n cs_call_center_sk AS id , \n sales , \n returns1 , \n (profit - profit_loss) AS profit \n FROM cs , \n cr \n UNION ALL \n SELECT 'web channel' AS channel , \n ws.wp_web_page_sk AS id , \n sales , \n COALESCE(returns1, 0) returns1 , \n (profit - COALESCE(profit_loss,0)) AS profit \n FROM ws \n LEFT JOIN wr \n ON ws.wp_web_page_sk = wr.wp_web_page_sk ) x \nGROUP BY channel, id\nORDER BY channel , \n id \nLIMIT 100; \n\n","destinationTable":{"projectId":"elite-fabric-384711","datasetId":"_3d6f639f1945a8d62dc8435595371d8a0b51c19a","tableId":"anon8b66db30c919f4f64d36f05c5ab2f1a8901d2f9978230213b7c4fdd2e3a970d2"},"writeDisposition":"WRITE_TRUNCATE","defaultDataset":{"datasetId":"scale_1","projectId":"elite-fabric-384711"},"priority":"INTERACTIVE","maximumBillingTier":10,"useLegacySql":false},"jobType":"QUERY"},"jobReference":{"projectId":"elite-fabric-384711","jobId":"query77_1683621387","location":"US"},"statistics":{"creationTime":"1683621387965","startTime":"1683621388058","endTime":"1683621388254","totalBytesProcessed":"0","query":{"totalBytesProcessed":"0","totalBytesBilled":"0","cacheHit":true,"statementType":"SELECT"}},"status":{"state":"DONE"},"principal_subject":"user:salqvist.philip@gmail.com"}
