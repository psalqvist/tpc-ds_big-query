{"kind":"bigquery#job","etag":"PQcJjPvUZGH/z8eDWwyXEA==","id":"elite-fabric-384711:US.query5_1683621218","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/elite-fabric-384711/jobs/query5_1683621218?location=US","user_email":"salqvist.philip@gmail.com","configuration":{"query":{"query":"-- query5\nWITH ssr AS \n( \n SELECT s_store_id, \n Sum(sales_price) AS sales, \n Sum(profit) AS profit, \n Sum(return_amt) AS returns1, \n Sum(net_loss) AS profit_loss \n FROM ( \n SELECT ss_store_sk AS store_sk, \n ss_sold_date_sk AS date_sk, \n ss_ext_sales_price AS sales_price, \n ss_net_profit AS profit, \n 0 AS return_amt, \n 0 AS net_loss \n FROM store_sales \n UNION ALL \n SELECT sr_store_sk AS store_sk, \n sr_returned_date_sk AS date_sk, \n 0 AS sales_price, \n 0 AS profit, \n sr_return_amt AS return_amt, \n sr_net_loss AS net_loss \n FROM store_returns ) salesreturns, \n date_dim, \n store \n WHERE date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2002-08-22' AS DATE) AND ( \n Cast('2002-09-05' AS DATE)) \n AND store_sk = s_store_sk \n GROUP BY s_store_id) , csr AS \n( \n SELECT cp_catalog_page_id, \n sum(sales_price) AS sales, \n sum(profit) AS profit, \n sum(return_amt) AS returns1, \n sum(net_loss) AS profit_loss \n FROM ( \n SELECT cs_catalog_page_sk AS page_sk, \n cs_sold_date_sk AS date_sk, \n cs_ext_sales_price AS sales_price, \n cs_net_profit AS profit, \n 0 AS return_amt, \n 0 AS net_loss \n FROM catalog_sales \n UNION ALL \n SELECT cr_catalog_page_sk AS page_sk, \n cr_returned_date_sk AS date_sk, \n 0 AS sales_price, \n 0 AS profit, \n cr_return_amount AS return_amt, \n cr_net_loss AS net_loss \n FROM catalog_returns ) salesreturns, \n date_dim, \n catalog_page \n WHERE date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2002-08-22' AS date) AND ( \n Cast('2002-09-05' AS DATE)) \n AND page_sk = cp_catalog_page_sk \n GROUP BY cp_catalog_page_id) , wsr AS \n( \n SELECT web_site_id, \n sum(sales_price) AS sales, \n sum(profit) AS profit, \n sum(return_amt) AS returns1, \n sum(net_loss) AS profit_loss \n FROM ( \n SELECT ws_web_site_sk AS wsr_web_site_sk, \n ws_sold_date_sk AS date_sk, \n ws_ext_sales_price AS sales_price, \n ws_net_profit AS profit, \n 0 AS return_amt, \n 0 AS net_loss \n FROM web_sales \n UNION ALL \n SELECT ws_web_site_sk AS wsr_web_site_sk, \n wr_returned_date_sk AS date_sk, \n 0 AS sales_price, \n 0 AS profit, \n wr_return_amt AS return_amt, \n wr_net_loss AS net_loss \n FROM web_returns \n LEFT OUTER JOIN web_sales \n ON ( \n wr_item_sk = ws_item_sk \n AND wr_order_number = ws_order_number) ) salesreturns,\n date_dim, \n web_site \n WHERE date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2002-08-22' AS date) AND ( \n Cast('2002-09-05' AS DATE)) \n AND wsr_web_site_sk = web_site_sk \n GROUP BY web_site_id) \nSELECT \n channel , \n id , \n sum(sales) AS sales , \n sum(returns1) AS returns1 , \n sum(profit) AS profit \nFROM ( \n SELECT 'store channel' AS channel , \n Concat('store', s_store_id) AS id , \n sales , \n returns1 , \n (profit - profit_loss) AS profit \n FROM ssr \n UNION ALL \n SELECT 'catalog channel' AS channel , \n Concat('catalog_page', cp_catalog_page_id) AS id , \n sales , \n returns1 , \n (profit - profit_loss) AS profit \n FROM csr \n UNION ALL \n SELECT 'web channel' AS channel , \n Concat('web_site', web_site_id) AS id , \n sales , \n returns1 , \n (profit - profit_loss) AS profit \n FROM wsr ) x \nGROUP BY channel, id\nORDER BY channel , \n id \nLIMIT 100; \n\n","destinationTable":{"projectId":"elite-fabric-384711","datasetId":"_3d6f639f1945a8d62dc8435595371d8a0b51c19a","tableId":"anon14bf1405d28c1ef89402ce1e4188b56f68a7a82eec558555ac21f368b0c324af"},"writeDisposition":"WRITE_TRUNCATE","defaultDataset":{"datasetId":"scale_1","projectId":"elite-fabric-384711"},"priority":"INTERACTIVE","maximumBillingTier":10,"useLegacySql":false},"jobType":"QUERY"},"jobReference":{"projectId":"elite-fabric-384711","jobId":"query5_1683621218","location":"US"},"statistics":{"creationTime":"1683621219248","startTime":"1683621219369","endTime":"1683621219583","totalBytesProcessed":"0","query":{"totalBytesProcessed":"0","totalBytesBilled":"0","cacheHit":true,"statementType":"SELECT"}},"status":{"state":"DONE"},"principal_subject":"user:salqvist.philip@gmail.com"}
