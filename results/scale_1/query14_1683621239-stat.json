{"kind":"bigquery#job","etag":"sHG6PUkBMIAGT+dPeeQtUw==","id":"elite-fabric-384711:US.query14_1683621239","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/elite-fabric-384711/jobs/query14_1683621239?location=US","user_email":"salqvist.philip@gmail.com","configuration":{"query":{"query":"-- query14\nWITH item_ss AS (\n SELECT DISTINCT \n iss.i_brand_id, \n iss.i_class_id, \n iss.i_category_id \n FROM store_sales, \n item iss, \n date_dim d1 \n WHERE ss_item_sk = iss.i_item_sk \n AND ss_sold_date_sk = d1.d_date_sk \n AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n), item_cs AS (\n SELECT DISTINCT \n ics.i_brand_id, \n ics.i_class_id, \n ics.i_category_id \n FROM catalog_sales, \n item ics, \n date_dim d2 \n WHERE cs_item_sk = ics.i_item_sk \n AND cs_sold_date_sk = d2.d_date_sk \n AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n), item_ws AS (\n SELECT DISTINCT \n iws.i_brand_id, \n iws.i_class_id, \n iws.i_category_id \n FROM web_sales, \n item iws, \n date_dim d3 \n WHERE ws_item_sk = iws.i_item_sk \n AND ws_sold_date_sk = d3.d_date_sk \n AND d3.d_year BETWEEN 1999 AND 1999 + 2\n), item_intersect AS (\n SELECT\n item_ss.i_brand_id brand_id, \n item_ss.i_class_id class_id, \n item_ss.i_category_id category_id \n FROM item_ss \n JOIN item_ws ON item_ss.i_brand_id = item_ws.i_brand_id \n AND item_ss.i_class_id = item_ws.i_class_id \n AND item_ss.i_category_id = item_ws.i_category_id \n JOIN item_cs ON item_ss.i_brand_id = item_cs.i_brand_id \n AND item_ss.i_class_id = item_cs.i_class_id \n AND item_ss.i_category_id = item_cs.i_category_id \n), cross_items AS (\n SELECT i_item_sk ss_item_sk \n FROM item, \n item_intersect\n WHERE i_brand_id = brand_id \n AND i_class_id = class_id \n AND i_category_id = category_id), \n avg_sales \n AS (SELECT Avg(quantity Readme.md benchmark.sh bootstrap.sh data_gen.sh load_data.sh query results tpc-ds-data-gen warmup list_price) average_sales \n FROM (SELECT ss_quantity quantity, \n ss_list_price list_price \n FROM store_sales, \n date_dim \n WHERE ss_sold_date_sk = d_date_sk \n AND d_year BETWEEN 1999 AND 1999 + 2 \n UNION ALL \n SELECT cs_quantity quantity, \n cs_list_price list_price \n FROM catalog_sales, \n date_dim \n WHERE cs_sold_date_sk = d_date_sk \n AND d_year BETWEEN 1999 AND 1999 + 2 \n UNION ALL \n SELECT ws_quantity quantity, \n ws_list_price list_price \n FROM web_sales, \n date_dim \n WHERE ws_sold_date_sk = d_date_sk \n AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT channel, \n i_brand_id, \n i_class_id, \n i_category_id, \n Sum(sales), \n Sum(number_sales) \nFROM (SELECT 'store' channel, \n i_brand_id, \n i_class_id, \n i_category_id, \n Sum(ss_quantity Readme.md benchmark.sh bootstrap.sh data_gen.sh load_data.sh query results tpc-ds-data-gen warmup ss_list_price) sales, \n Count(*) number_sales \n FROM store_sales, \n item, \n date_dim \n WHERE ss_item_sk IN (SELECT ss_item_sk \n FROM cross_items) \n AND ss_item_sk = i_item_sk \n AND ss_sold_date_sk = d_date_sk \n AND d_year = 1999 + 2 \n AND d_moy = 11 \n GROUP BY i_brand_id, \n i_class_id, \n i_category_id \n HAVING Sum(ss_quantity Readme.md benchmark.sh bootstrap.sh data_gen.sh load_data.sh query results tpc-ds-data-gen warmup ss_list_price) > (SELECT average_sales \n FROM avg_sales) \n UNION ALL \n SELECT 'catalog' channel, \n i_brand_id, \n i_class_id, \n i_category_id, \n Sum(cs_quantity Readme.md benchmark.sh bootstrap.sh data_gen.sh load_data.sh query results tpc-ds-data-gen warmup cs_list_price) sales, \n Count(*) number_sales \n FROM catalog_sales, \n item, \n date_dim \n WHERE cs_item_sk IN (SELECT ss_item_sk \n FROM cross_items) \n AND cs_item_sk = i_item_sk \n AND cs_sold_date_sk = d_date_sk \n AND d_year = 1999 + 2 \n AND d_moy = 11 \n GROUP BY i_brand_id, \n i_class_id, \n i_category_id \n HAVING Sum(cs_quantity Readme.md benchmark.sh bootstrap.sh data_gen.sh load_data.sh query results tpc-ds-data-gen warmup cs_list_price) > (SELECT average_sales \n FROM avg_sales) \n UNION ALL \n SELECT 'web' channel, \n i_brand_id, \n i_class_id, \n i_category_id, \n Sum(ws_quantity Readme.md benchmark.sh bootstrap.sh data_gen.sh load_data.sh query results tpc-ds-data-gen warmup ws_list_price) sales, \n Count(*) number_sales \n FROM web_sales, \n item, \n date_dim \n WHERE ws_item_sk IN (SELECT ss_item_sk \n FROM cross_items) \n AND ws_item_sk = i_item_sk \n AND ws_sold_date_sk = d_date_sk \n AND d_year = 1999 + 2 \n AND d_moy = 11 \n GROUP BY i_brand_id, \n i_class_id, \n i_category_id \n HAVING Sum(ws_quantity Readme.md benchmark.sh bootstrap.sh data_gen.sh load_data.sh query results tpc-ds-data-gen warmup ws_list_price) > (SELECT average_sales \n FROM avg_sales)) y \nGROUP BY channel, i_brand_id, i_class_id, i_category_id \nORDER BY channel, \n i_brand_id, \n i_class_id, \n i_category_id\nLIMIT 100; ","destinationTable":{"projectId":"elite-fabric-384711","datasetId":"_3d6f639f1945a8d62dc8435595371d8a0b51c19a","tableId":"anon87e5fa33daeac7c3b67f8ec4171d0fa4aee8be5d002d06ca5a665ec97d2392f4"},"writeDisposition":"WRITE_TRUNCATE","defaultDataset":{"datasetId":"scale_1","projectId":"elite-fabric-384711"},"priority":"INTERACTIVE","maximumBillingTier":10,"useLegacySql":false},"jobType":"QUERY"},"jobReference":{"projectId":"elite-fabric-384711","jobId":"query14_1683621239","location":"US"},"statistics":{"creationTime":"1683621240068","startTime":"1683621240162","endTime":"1683621240347","totalBytesProcessed":"0","query":{"totalBytesProcessed":"0","totalBytesBilled":"0","cacheHit":true,"statementType":"SELECT"}},"status":{"state":"DONE"},"principal_subject":"user:salqvist.philip@gmail.com"}
